<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Running Integrations :: Apache Camel</title>
    <link rel="canonical" href="https://camel.apache.org/camel-k/latest/running.html">
    <meta name="generator" content="Antora 2.0.0-rc.1">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://camel.apache.org">Apache Camel</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="camel-k" data-version="latest">
  <aside class="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Apache Camel K</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="installation/index.html">Installing Camel K</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation/minikube.html">Minikube</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation/minishift.html">Minishift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation/gke.html">Google Kubernetes Engine (GKE)</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="running.html">Running Integrations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configuration/index.html">Configuration</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Apache Camel K</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Apache Camel K</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Component reference</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../components/2.24.0-SNAPSHOT/index.html">2.24.0-SNAPSHOT</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">User manual</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../manual/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../manual/latest/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
  <ul>
    <li class="crumb"><a href="index.html">Apache Camel K</a></li>
    <li class="crumb"><a href="running.html">Running Integrations</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/apache/camel-k/edit/antora/docs/modules/ROOT/pages/running.adoc">Edit this Page</a></div>
</div>
<article class="doc">
<h1>Running Integrations</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>After completing the <a href="installation/index.html" class="page">installation</a> you should be connected to a Kubernetes/OpenShift cluster
and have the "kamel" CLI correctly configured.</p>
</div>
<div class="paragraph">
<p><strong>TODO</strong> Continue from here!</p>
</div>
<div class="paragraph">
<p>You can now, you can run a Camel integration on the cluster by executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel run examples/Sample.java</code></pre>
</div>
</div>
<div class="paragraph">
<p>A "Sample.java" file is included in the <a href="/examples">/examples</a> folder of this repository. You can change the content of the file and execute the command again to see the changes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_integration_properties"><a class="anchor" href="#_configure_integration_properties"></a>Configure Integration properties</h4>
<div class="paragraph">
<p>Properties associated to an integration can be configured either using a ConfigMap/Secret or by setting using the "--property" flag, i.e.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel run --property my.message=test examples/props.js</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_integration_logging"><a class="anchor" href="#_configure_integration_logging"></a>Configure Integration Logging</h4>
<div class="paragraph">
<p>camel-k runtime uses log4j2 as logging framework and can be configured through integration properties.
If you need to change the logging level of various loggers, you can do so by using the <code>logging.level</code> prefix:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>logging.level.org.apache.camel = DEBUG</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configure_integration_components"><a class="anchor" href="#_configure_integration_components"></a>Configure Integration Components</h4>
<div class="paragraph">
<p>camel-k component can be configured programmatically inside an integration or using properties with the following syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>camel.component.${scheme}.${property} = ${value}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As example if you want to change the queue size of the seda component, you can use the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>camel.component.seda.queueSize = 10</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_integrations_in_dev_mode_for_fast_feedback"><a class="anchor" href="#_running_integrations_in_dev_mode_for_fast_feedback"></a>Running Integrations in "Dev" Mode for Fast Feedback</h3>
<div class="paragraph">
<p>If you want to iterate quickly on an integration to have fast feedback on the code you&#8217;re writing, you can use by running it in <strong>"dev" mode</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel run examples/Sample.java --dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>--dev</code> flag deploys immediately the integration and shows the integration logs in the console. You can then change the code and see
the <strong>changes automatically applied (instantly)</strong> to the remote integration pod.</p>
</div>
<div class="paragraph">
<p>The console follows automatically all redeploys of the integration.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of the output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[nferraro@localhost camel-k]$ kamel run examples/Sample.java --dev
integration "sample" created
integration "sample" in phase Building
integration "sample" in phase Deploying
integration "sample" in phase Running
[1] Monitoring pod sample-776db787c4-zjhfr[1] Starting the Java application using /opt/run-java/run-java.sh ...
[1] exec java -javaagent:/opt/prometheus/jmx_prometheus_javaagent.jar=9779:/opt/prometheus/prometheus-config.yml -XX:+UseParallelGC -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90 -XX:MinHeapFreeRatio=20 -XX:MaxHeapFreeRatio=40 -XX:+ExitOnOutOfMemoryError -cp .:/deployments/* org.apache.camel.k.jvm.Application
[1] [INFO ] 2018-09-20 21:24:35.953 [main] Application - Routes: file:/etc/camel/conf/Sample.java
[1] [INFO ] 2018-09-20 21:24:35.955 [main] Application - Language: java
[1] [INFO ] 2018-09-20 21:24:35.956 [main] Application - Locations: file:/etc/camel/conf/application.properties
[1] [INFO ] 2018-09-20 21:24:36.506 [main] DefaultCamelContext - Apache Camel 2.22.1 (CamelContext: camel-1) is starting
[1] [INFO ] 2018-09-20 21:24:36.578 [main] ManagedManagementStrategy - JMX is enabled
[1] [INFO ] 2018-09-20 21:24:36.680 [main] DefaultTypeConverter - Type converters loaded (core: 195, classpath: 0)
[1] [INFO ] 2018-09-20 21:24:36.777 [main] DefaultCamelContext - StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
[1] [INFO ] 2018-09-20 21:24:36.817 [main] DefaultCamelContext - Route: route1 started and consuming from: timer://tick
[1] [INFO ] 2018-09-20 21:24:36.818 [main] DefaultCamelContext - Total 1 routes, of which 1 are started
[1] [INFO ] 2018-09-20 21:24:36.820 [main] DefaultCamelContext - Apache Camel 2.22.1 (CamelContext: camel-1) started in 0.314 seconds</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dependencies_and_component_resolution"><a class="anchor" href="#_dependencies_and_component_resolution"></a>Dependencies and Component Resolution</h3>
<div class="paragraph">
<p>Camel components used in an integration are automatically resolved. For example, take the following integration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>from("imap://admin@myserver.com")
  .to("seda:output")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the integration is using the <strong>"imap:" prefix</strong>, Camel K is able to <strong>automatically add the "camel-mail" component</strong> to the list of required dependencies.
This will be transparent to the user, that will just see the integration running.</p>
</div>
<div class="paragraph">
<p>Automatic resolution is also a nice feature in <code>--dev</code> mode, because you are allowed to add all components you need without exiting the dev loop.</p>
</div>
<div class="paragraph">
<p>You can also use the <code>-d</code> flag to pass additional explicit dependencies to the Camel client tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel run -d mvn:com.google.guava:guava:26.0-jre -d camel-mina2 Integration.java</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_not_just_java"><a class="anchor" href="#_not_just_java"></a>Not Just Java</h3>
<div class="paragraph">
<p>Camel K supports multiple languages for writing integrations:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Languages</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Language</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Both integrations in source <code>.java</code> files or compiled <code>.class</code> file can be run.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrations written in plain XML DSL are supported (Spring XML or Blueprint not supported).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groovy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Groovy <code>.groovy</code> files are supported (experimental).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaScript</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JavaScript <code>.js</code> files are supported (experimental).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kotlin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kotlin Script <code>.kts</code> files are supported (experimental).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>More information about supported languages is provided in the <a href="docs/languages.adoc">languages guide</a>.</p>
</div>
<div class="paragraph">
<p>Integrations written in different languages are provided in the <a href="/examples">examples</a> directory.</p>
</div>
<div class="paragraph">
<p>An example of integration written in JavaScript is the <a href="/examples/dns.js">/examples/dns.js</a> integration.
Here&#8217;s the content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>// Lookup every second the 'www.google.com' domain name and log the output
from('timer:dns?period=1s')
    .routeId('dns')
    .setHeader('dns.domain')
        .constant('www.google.com')
    .to('dns:ip')
    .to('log:dns');</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run it, you need just to execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel run examples/dns.js</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_traits"><a class="anchor" href="#_traits"></a>Traits</h3>
<div class="paragraph">
<p>The details of how the integration is mapped into Kubernetes resources can be <strong>customized using traits</strong>.
More information is provided in the <a href="docs/traits.adoc">traits section</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_the_status"><a class="anchor" href="#_monitoring_the_status"></a>Monitoring the Status</h3>
<div class="paragraph">
<p>Camel K integrations follow a lifecycle composed of several steps before getting into the <code>Running</code> state.
You can check the status of all integrations by executing the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kamel get</code></pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a>Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We love contributions and we want to make Camel K great!</p>
</div>
<div class="paragraph">
<p>Contributing is easy, just take a look at our <a href="/docs/developers.adoc">developer&#8217;s guide</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="uninstalling"><a class="anchor" href="#uninstalling"></a>Uninstalling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you really need to, it is possible to completely uninstall Camel K from OpenShift or Kubernetes with the following command, using the "oc" or "kubectl" tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code># kubectl on plain Kubernetes
oc delete all,pvc,configmap,rolebindings,clusterrolebindings,secrets,sa,roles,clusterroles,crd -l 'app=camel-k'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="licensing"><a class="anchor" href="#licensing"></a>Licensing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This software is licensed under the terms you may find in the file named LICENSE in this directory.</p>
</div>
</div>
</div>
</article>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
